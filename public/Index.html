<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Exam Application - Home</title>
  <link rel="stylesheet" href="/style.css">
</head>

<body>
  <!-- Navbar -->
  <div class="nav">
    <h1>Exam Application</h1>
    <div class="nav-links">
      <a href="/">Home</a>
      <a href="/admin" id="adminLink" style="display:none;">Admin</a>
      <a href="/exam">Exam</a>
      <a href="/signup" id="signupLink">Signup</a>
      <a href="/login" id="loginLink">Login</a>
      <a href="/logout" id="logoutLink" style="display:none;">Logout</a>
      <a href="/profile" id="profileLink" style="display:none;"><img src="/profile.png" alt="Profile" width="25" /></a>
    </div>
    <button class="hamburger">â˜°</button>
  </div>

  <!-- Hero Section -->
  <div class="hero">
    <h1>Welcome to the Online Exam Platform</h1>
    <p>Take exams anytime, track your progress, and improve your skills with ease.</p>
    <a href="/login" class="btn" id="cta-signup">Get Started</a>
    <a href="/exam" class="btn" id="cta-exam">Take Exam</a>
  </div>

  <!-- Features Section -->
  <div class="features">
    <div class="feature">
      <h3>Online Exams</h3>
      <p>Take exams anytime, anywhere. All questions are saved automatically.</p>
    </div>
    <div class="feature">
      <h3>Instant Results</h3>
      <p>Get immediate feedback and scores after submitting your exam.</p>
    </div>
    <div class="feature">
      <h3>Progress Tracking</h3>
      <p>Monitor your performance over time with detailed results history.</p>
    </div>
    <div class="feature">
      <h3>Secure & Reliable</h3>
      <p>Your exams and data are secure and reliably stored.</p>
    </div>
  </div>

  <!-- Instructions Section -->
  <div class="instructions">
    <h2>How It Works</h2>
    <ol>
      <li>Signup or Login to start your exam.</li>
      <li>Click "Start Exam" to begin. You will have a timer.</li>
      <li>Answer the questions. Selected answers are saved automatically.</li>
      <li>Submit the exam to see your score.</li>
      <li>You cannot leave the exam page without submitting.</li>
    </ol>
  </div>

  <!-- Logged-in User Shortcuts -->
  <div id="user-shortcuts">
    <h3>Welcome, <span id="username"></span>!</h3>
    <a href="/exam" class="btn">Start Exam</a>
    <a href="/profile" class="btn">Profile</a>
  </div>

  <!-- Footer -->
  <div class="footer">
    <p>&copy; 2025 DS Computer Institute. All rights reserved.</p>
  </div>

  <script>
    // Hamburger menu toggle
    const hamburger = document.querySelector(".hamburger");
    const navLinks = document.querySelector(".nav-links");
    hamburger.addEventListener("click", () => {
      navLinks.classList.toggle("active");
    });

    // Auth check & links visibility
    document.addEventListener("DOMContentLoaded", async () => {
      const loginLink = document.getElementById('loginLink');
      const signupLink = document.getElementById('signupLink');
      const logoutLink = document.getElementById('logoutLink');
      const profileLink = document.getElementById('profileLink');
      const adminLink = document.getElementById('adminLink');
      const userShortcuts = document.getElementById('user-shortcuts');
      const usernameSpan = document.getElementById('username');

      try {
        const res = await fetch('/check-auth');
        const data = await res.json();

        if (data.loggedIn) {
          loginLink.style.display = 'none';
          signupLink.style.display = 'none';
          logoutLink.style.display = 'inline-block';
          profileLink.style.display = 'inline-block';
          userShortcuts.style.display = 'block';
          usernameSpan.textContent = data.user.username || "User";

          if (data.user.role === "admin") adminLink.style.display = 'inline-block';
          else adminLink.style.display = 'none';
        } else {
          loginLink.style.display = 'inline-block';
          signupLink.style.display = 'inline-block';
          logoutLink.style.display = 'none';
          profileLink.style.display = 'none';
          userShortcuts.style.display = 'none';
          adminLink.style.display = 'none';
        }
      } catch (err) {
        console.error('Auth check failed', err);
      }
    });
  </script>
</body>

</html>
